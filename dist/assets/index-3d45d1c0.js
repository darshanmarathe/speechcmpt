import{render as y,html as u}from"https://unpkg.com/lit-html?module";import{unsafeHTML as p}from"https://unpkg.com/lit-html/directives/unsafe-html?module";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();class b extends HTMLElement{constructor(t=!0,i={}){var e;if(super(),this.props={},this.state={},this.scripts=[],this.Template===void 0&&this.Style===void 0)throw new Error("Template and Style functions are required....");Object.keys(i).length>0&&(this.props=i),t?this.root=this.attachShadow({mode:"open"}):(this.innerHTML="",this.root=this),this.BuildProps(),this.makeDynamicProps(),this.Template.bind(this),this.Style.bind(this),this.slotChnaged&&this.slotChnaged.bind(this),(e=this.root.querySelectorAll("slot"))===null||e===void 0||e.forEach(s=>{s.addEventListener("slotchange",o=>{this.slotChnaged&&this.slotChnaged(o),this.ComponentDidMount&&this.ComponentDidMount()})}),setTimeout(()=>{this.PreRender(),this.GetSlots()},100)}async BuildProps(){let t=this.getAttributeNames();if(t.length===0)return;let i={};for(const e of t)if(e.toLowerCase().startsWith("data-")){let s=JSON.parse(this.getAttribute(e)||"{}");i[e.replace("data-","")]=typeof this.getAttribute(e)=="object"?this.getAttribute(e):s}else i[e]=this.getAttribute(e);this.props=Object.assign(Object.assign({},this.props),i)}get(t){return new Promise((i,e)=>{fetch(t).then(async s=>{const o=s.json();i(o)}).catch(s=>{i(s)})})}loadScript(t,i){return new Promise((e,s)=>{let o=document.getElementById(t);if(!o)o=document.createElement("script"),o.src=i,o.id=t,o.async=!1;else{e();return}this.scripts.push(()=>{document.body.removeChild(o)}),document.body.appendChild(o),o.onload=()=>{e()}})}loadCss(t,i){let e=this.root.getElementById(t);e||(e=document.createElement("link"),e.href=i,e.id=t,e.rel="stylesheet"),this.root.appendChild(e),this.scripts.push(()=>{this.root.removeChild(e)})}post(t,i){return new Promise(async(e,s)=>{try{const r=await(await fetch(t,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(i)})).json();e(r)}catch(o){s(o)}finally{this.Log(`POST Request finished for ${t} ${JSON.stringify(i)}`)}})}GetSlots(){this.slots=this.root.querySelectorAll("slot"),this.slots.forEach((t,i)=>{if(t.hasAttribute("handled"))return;let e=t.assignedNodes();if(e.length>0){debugger;const s=e[0].getAttributeNames();for(const o of s)["name","id","slot"].indexOf(o)>-1||(e[0][o]=t[o]);t.setAttribute("handled",!0)}})}makeDynamicProps(){this.props&&Object.keys(this.props).length&&Object.keys(this.props).forEach(t=>{Object.defineProperty(this,t,{get(){return this.getAttribute(t)},set(i){let e=this.props[t];console.log(t,e,i),i!==void 0?(this.setAttribute(t,i),this.props[t]=i,e!==i&&this.PreRender()):this.removeAttribute(t),this.ComponentDidReceiedProps&&this.ComponentDidReceiedProps(t,e,i)}})})}setState(t,i=!0,e=()=>{}){this.state=Object.assign(this.state,t),i===!0&&this.PreRender(),e()}PreRender(){y(u`${this.Style()} ${this.Template()}`,this.root),this.GetSlots()}Tmpl(t,i,e=null){let s=i;if(typeof e=="string"){const n=document.createElement("div");n.innerHTML=e,e=n.children[0]}const o=(n,c)=>{let d=c;const f=n.split(".");for(const m of f){const a=m.split("."),g=a.length>1?a[1]:a[0];d=d[g]}return d},r=/{(.*?)}/g,h=s.match(r);if(h==null||h.forEach(n=>{n=n.replace("{","").replace("}",""),n.indexOf(".")===-1?s=s.replace(`{${n}}`,t[n]):s=s.replace(`{${n}}`,o(n,t))}),e){const n=Object.keys(t);for(const c of n)e[c]=t[c]}return e!==null&&s!==""?(e.innerHTML=p(s),p(s)):e===null&&s!==""?p(s):e}Log(...t){this.props.debug&&console.log(...t)}async connectedCallback(){this.ComponentDidMount&&await this.ComponentDidMount()}async disconnectedCallback(){this.scripts.forEach(t=>t()),this.ComponentWillUnmount&&await this.ComponentWillUnmount()}attributeChangedCallback(t,i,e){console.log(t,"attribute changed"),this.BuildProps()}fireEvent(t,i,e,s=!0,o=!0){i&&i!=""&&(this[i]=e),this.dispatchEvent(new CustomEvent(t,{detail:e,bubbles:s,composed:o}))}getProps(t=!1){return t?JSON.stringify(this.props,null,4):this.props}getState(t=!1){return t?JSON.stringify(this.state,null,4):this.state}}function C(l,t){window.customElements.define(l,t)}class O extends b{Template(){u`
            <div>

                Hello world

            </div>
        
        `}Style(){return""}}C("voice-chat",O);
